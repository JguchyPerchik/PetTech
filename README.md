# Mr. Kranch Brand Blocks Analyzer

## ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°
Ð”Ð°Ð½Ð½Ñ‹Ð¹ ÑÐºÑ€Ð¸Ð¿Ñ‚ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð¸Ñ€ÑƒÐµÑ‚ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÑƒ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¾ Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð°Ñ… Ð¸ Ñ„Ð¾Ñ€Ð¼Ð¸Ñ€ÑƒÐµÑ‚ Ñ€ÐµÐ¹Ñ‚Ð¸Ð½Ð³ ÑƒÑ‡Ð°ÑÑ‚Ð½Ð¸ÐºÐ¾Ð² Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ñ‹ **Mr. Kranch**.  
ÐžÑÐ½Ð¾Ð²Ð½Ð°Ñ Ð·Ð°Ð´Ð°Ñ‡Ð° â€“ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚ÑŒ, ÑÐºÐ¾Ð»ÑŒÐºÐ¾ **Ð±Ñ€ÐµÐ½Ð´-Ð±Ð»Ð¾ÐºÐ¾Ð²** ÑÐ¾Ð±Ñ€Ð°Ð» ÐºÐ°Ð¶Ð´Ñ‹Ð¹ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€, Ð¸ ÑÐ¾ÑÑ‚Ð°Ð²Ð¸Ñ‚ÑŒ Ñ€ÐµÐ¹Ñ‚Ð¸Ð½Ð³ Ð¿Ð¾ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ñƒ Ð±Ð»Ð¾ÐºÐ¾Ð², ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ñƒ ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ð´Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ð¾Ð² Ð¸ ÑÑƒÐ¼Ð¼Ðµ Ð¿Ñ€Ð¾Ð´Ð°Ð¶.

Ð‘Ñ€ÐµÐ½Ð´-Ð±Ð»Ð¾ÐºÐ¸ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÑÑŽÑ‚ÑÑ Ð¿Ð¾ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¼ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°Ð¼:

- **Play** â€“ 20 SKU ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ *Ð˜Ð³Ñ€ÑƒÑˆÐºÐ¸*  
- **Happy Launch** â€“ 40 SKU ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ *Ð˜Ð³Ñ€ÑƒÑˆÐºÐ¸*  
- **Discovery** â€“ 25 SKU ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ *Ð˜Ð³Ñ€ÑƒÑˆÐºÐ¸* + 15 SKU ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ *ÐœÐ¸ÑÐºÐ¸*  

## ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»
1. **Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ…** Ð¸Ð· Excel (`Mr. Kranch.xlsx`).  
2. **ÐŸÑ€ÐµÐ´Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ…**:
   - ÐžÑ‡Ð¸ÑÑ‚ÐºÐ° Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ð¹ ÑÑ‚Ð¾Ð»Ð±Ñ†Ð¾Ð².
   - ÐŸÑ€ÐµÐ¾Ð±Ñ€Ð°Ð·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ‡Ð¸ÑÐ»Ð¾Ð²Ñ‹Ñ… Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ð¹ (`Amount`, `Price`) Ð² `float`.
3. **ÐŸÐ¾Ð´ÑÑ‡ÐµÑ‚ Ð±Ñ€ÐµÐ½Ð´-Ð±Ð»Ð¾ÐºÐ¾Ð²**:
   - Ð”Ð»Ñ ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ Ð·Ð°ÐºÐ°Ð·Ð° Ñ‚Ð¾Ð²Ð°Ñ€Ñ‹ ÑÐ¾Ñ€Ñ‚Ð¸Ñ€ÑƒÑŽÑ‚ÑÑ Ð¿Ð¾ ÑƒÐ±Ñ‹Ð²Ð°Ð½Ð¸ÑŽ Ñ†ÐµÐ½Ñ‹.
   - ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ÑÑ, ÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð±Ð»Ð¾ÐºÐ¾Ð² Ð¼Ð¾Ð¶Ð½Ð¾ ÑÐ¾Ð±Ñ€Ð°Ñ‚ÑŒ (Ð¿Ñ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚ â€“ Ð´Ð¾Ñ€Ð¾Ð³Ð¸Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ñ‹).
   - Ð£Ñ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÑŽÑ‚ÑÑ Ð²ÑÐµ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ñ‹Ðµ ÐºÐ¾Ð¼Ð±Ð¸Ð½Ð°Ñ†Ð¸Ð¸ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, ÐµÑÐ»Ð¸ Ð·Ð°ÐºÐ°Ð· ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ 60 SKU Ð¸Ð³Ñ€ÑƒÑˆÐµÐº â†’ 1 Ð±Ð»Ð¾Ðº Happy Launch + 1 Ð±Ð»Ð¾Ðº Play).
   - Ð’ Ñ€Ð°ÑÑ‡ÐµÑ‚ Ð²ÐºÐ»ÑŽÑ‡Ð°ÑŽÑ‚ÑÑ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ñ‚Ð¾Ð²Ð°Ñ€Ñ‹, Ð²Ð¾ÑˆÐµÐ´ÑˆÐ¸Ðµ Ð² Ð±Ñ€ÐµÐ½Ð´-Ð±Ð»Ð¾ÐºÐ¸.
4. **Ð¤Ð¾Ñ€Ð¼Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑÐ²Ð¾Ð´ÐºÐ¸ (`summary`)**:
   - ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ð´Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ð¾Ð² Ñ Ð±Ñ€ÐµÐ½Ð´-Ð±Ð»Ð¾ÐºÐ°Ð¼Ð¸.
   - ÐžÐ±Ñ‰Ð°Ñ ÑÑƒÐ¼Ð¼Ð° Ð¿Ñ€Ð¾Ð´Ð°Ð¶ Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð², Ð²Ñ…Ð¾Ð´ÑÑ‰Ð¸Ñ… Ð² Ð±Ñ€ÐµÐ½Ð´-Ð±Ð»Ð¾ÐºÐ¸.
   - ÐžÐ±Ñ‰ÐµÐµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÐ¾Ð±Ñ€Ð°Ð½Ð½Ñ‹Ñ… Ð±Ñ€ÐµÐ½Ð´-Ð±Ð»Ð¾ÐºÐ¾Ð².
5. **Ð Ð°Ð½Ð¶Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð¾Ð²**:
   - Ð”Ð»Ñ ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ ÑƒÑ‡Ð°ÑÑ‚Ð½Ð¸ÐºÐ° Ð²Ñ‹Ñ‡Ð¸ÑÐ»ÑÐµÑ‚ÑÑ Ð¼ÐµÑÑ‚Ð¾ Ð² Ñ€ÐµÐ¹Ñ‚Ð¸Ð½Ð³Ðµ Ð¿Ð¾ Ñ‚Ñ€Ñ‘Ð¼ Ð¿Ð¾ÐºÐ°Ð·Ð°Ñ‚ÐµÐ»ÑÐ¼:
     - ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð±Ñ€ÐµÐ½Ð´-Ð±Ð»Ð¾ÐºÐ¾Ð².
     - ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð´Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ð¾Ð².
     - Ð¡ÑƒÐ¼Ð¼Ð° Ð¿Ñ€Ð¾Ð´Ð°Ð¶.
   - Ð˜Ñ‚Ð¾Ð³Ð¾Ð²Ñ‹Ð¹ Ð±Ð°Ð»Ð» = ÑÑƒÐ¼Ð¼Ð° Ð¼ÐµÑÑ‚ Ð¿Ð¾ Ñ‚Ñ€Ñ‘Ð¼ Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ°Ð¼.
   - ÐŸÐ¾Ð±ÐµÐ¶Ð´Ð°ÐµÑ‚ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€ Ñ **Ð¼Ð¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¼ Ð±Ð°Ð»Ð»Ð¾Ð¼**.
6. **Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð²** Ð² Excel:
   - `Mr. Kranch_full.xlsx` â€“ Ð´ÐµÑ‚Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾ Ð·Ð°ÐºÐ°Ð·Ð°Ð¼ Ð¸ Ð±Ð»Ð¾ÐºÐ°Ð¼.
   - `Mr. Kranch_calc.xlsx` â€“ ÑÐ²Ð¾Ð´Ð½Ð°Ñ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð° Ð¿Ð¾ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð°Ð¼.
   - `Mr. Kranch_ranking.xlsx` â€“ Ð¸Ñ‚Ð¾Ð³Ð¾Ð²Ñ‹Ð¹ Ñ€ÐµÐ¹Ñ‚Ð¸Ð½Ð³.

## Ð’Ñ…Ð¾Ð´Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ
Ð¤Ð°Ð¹Ð» `Mr. Kranch.xlsx` Ð´Ð¾Ð»Ð¶ÐµÐ½ ÑÐ¾Ð´ÐµÑ€Ð¶Ð°Ñ‚ÑŒ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ðµ ÑÑ‚Ð¾Ð»Ð±Ñ†Ñ‹:
- **Manager** â€“ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€, Ð¾Ñ„Ð¾Ñ€Ð¼Ð¸Ð²ÑˆÐ¸Ð¹ Ð·Ð°ÐºÐ°Ð·.  
- **Contract_ID** â€“ Ð½Ð¾Ð¼ÐµÑ€ Ð´Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ð°.  
- **Order** â€“ Ð¸Ð´ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ð¾Ñ€ Ð·Ð°ÐºÐ°Ð·Ð°.  
- **Nomenclature_ID** â€“ ID Ñ‚Ð¾Ð²Ð°Ñ€Ð°.  
- **Category** â€“ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ Ñ‚Ð¾Ð²Ð°Ñ€Ð° (*Ð˜Ð³Ñ€ÑƒÑˆÐºÐ¸* Ð¸Ð»Ð¸ *ÐœÐ¸ÑÐºÐ¸*).  
- **Quantity** â€“ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ SKU Ð² Ð·Ð°ÐºÐ°Ð·Ðµ.  
- **Amount** â€“ ÑÑƒÐ¼Ð¼Ð° Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð¸.  
- **Price** â€“ Ñ†ÐµÐ½Ð° Ð·Ð° ÐµÐ´Ð¸Ð½Ð¸Ñ†Ñƒ.  

## Ð’Ñ‹Ñ…Ð¾Ð´Ð½Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹
- `Mr. Kranch_full.xlsx` â€“ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾ ÐºÐ°Ð¶Ð´Ð¾Ð¼Ñƒ Ð·Ð°ÐºÐ°Ð·Ñƒ Ñ ÑƒÑ‡ÐµÑ‚Ð¾Ð¼ ÑÐ¾Ð±Ñ€Ð°Ð½Ð½Ñ‹Ñ… Ð±Ð»Ð¾ÐºÐ¾Ð².  
- `Mr. Kranch_calc.xlsx` â€“ Ð°Ð³Ñ€ÐµÐ³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð°Ñ ÑÐ²Ð¾Ð´ÐºÐ° Ð¿Ð¾ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð°Ð¼.  
- `Mr. Kranch_ranking.xlsx` â€“ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð° Ñ Ð¸Ñ‚Ð¾Ð³Ð¾Ð²Ñ‹Ð¼ Ñ€ÐµÐ¹Ñ‚Ð¸Ð½Ð³Ð¾Ð¼ ÑƒÑ‡Ð°ÑÑ‚Ð½Ð¸ÐºÐ¾Ð².  

## ÐšÐ°Ðº Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ
1. Ð¡ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÑÐºÑ€Ð¸Ð¿Ñ‚ Ð² Jupyter Notebook Ð¸Ð»Ð¸ Python-Ñ„Ð°Ð¹Ð».  
2. Ð£Ð±ÐµÐ´Ð¸Ñ‚ÑŒÑÑ, Ñ‡Ñ‚Ð¾ Ð²Ñ…Ð¾Ð´Ð½Ð¾Ð¹ Ñ„Ð°Ð¹Ð» `Mr. Kranch.xlsx` Ð½Ð°Ñ…Ð¾Ð´Ð¸Ñ‚ÑÑ Ð² Ñ€Ð°Ð±Ð¾Ñ‡ÐµÐ¹ Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸Ð¸.  
3. Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ ÑÐºÑ€Ð¸Ð¿Ñ‚.
```
python Mr. Kranch_calc.py
```

4. Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÑŽÑ‚ÑÑ Ð² Excel-Ñ„Ð°Ð¹Ð»Ñ‹.  

## ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹
Ð”Ð¾Ð¿ÑƒÑÑ‚Ð¸Ð¼, ÑƒÑ‡Ð°ÑÑ‚Ð²ÑƒÑŽÑ‚ Ñ‚Ñ€Ð¸ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð°:

| ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÐµÐ»ÑŒ         | ÐœÐµÐ½ÐµÐ´Ð¶ÐµÑ€ 1 | ÐœÐµÐ½ÐµÐ´Ð¶ÐµÑ€ 2 | ÐœÐµÐ½ÐµÐ´Ð¶ÐµÑ€ 3 |
|--------------------|------------|------------|------------|
| ÐšÐ¾Ð»-Ð²Ð¾ Ð±Ð»Ð¾ÐºÐ¾Ð²      | 2          | 3          | 1          |
| ÐšÐ¾Ð»-Ð²Ð¾ Ð´Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ð¾Ð²   | 2          | 3          | 1          |
| Ð¡ÑƒÐ¼Ð¼Ð° Ð¿Ñ€Ð¾Ð´Ð°Ð¶       | 7,577      | 17,267     | 3,789      |

Ð Ð°Ð½Ð¶Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð´Ð°ÑÑ‚ Ñ‚Ð°ÐºÐ¸Ðµ Ð¼ÐµÑÑ‚Ð°:

| ÐœÐµÐ½ÐµÐ´Ð¶ÐµÑ€   | Rank_blocks | Rank_contracts | Rank_sales | Total_score |
|------------|-------------|----------------|------------|-------------|
| ÐœÐµÐ½ÐµÐ´Ð¶ÐµÑ€ 1 | 2           | 2              | 2          | 6           |
| ÐœÐµÐ½ÐµÐ´Ð¶ÐµÑ€ 2 | 1           | 1              | 1          | 3           |
| ÐœÐµÐ½ÐµÐ´Ð¶ÐµÑ€ 3 | 3           | 3              | 3          | 9           |

ðŸ† ÐŸÐ¾Ð±ÐµÐ´Ð¸Ñ‚ÐµÐ»ÐµÐ¼ ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑÑ **ÐœÐµÐ½ÐµÐ´Ð¶ÐµÑ€ 2** Ñ Ð¼Ð¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¼ Ð¸Ñ‚Ð¾Ð³Ð¾Ð²Ñ‹Ð¼ Ð±Ð°Ð»Ð»Ð¾Ð¼.

## Ð¤ÑƒÐ½ÐºÑ†Ð¸Ð¸
1. Ð’Ñ‹ÑÐ²Ð»ÐµÐ½Ð¸Ðµ Ð¸ Ð¿Ð¾Ð´ÑÑ‡Ñ‘Ñ‚ Ð±Ñ€ÐµÐ½Ð´-Ð±Ð»Ð¾ÐºÐ¾Ð²
```python
def count_brand_blocks(order_df):
    order_df = order_df.sort_values(by='Price', ascending=False)
    blocks = {'Play': 0, 'Happy Launch': 0, 'Discovery': 0}
    used_ids = set()  # SKU, ÑƒÐ¶Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ Ð² Ð±Ð»Ð¾ÐºÐ°Ñ…
    included_rows = []  # Ð´Ð»Ñ Ð¿Ð¾ÑÐ»ÐµÐ´ÑƒÑŽÑ‰ÐµÐ³Ð¾ ÑÑƒÐ¼Ð¼Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¿Ñ€Ð¾Ð´Ð°Ð¶

    # Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ "ÑÐ±Ð¾Ñ€ÐºÐ¸" Ð±Ð»Ð¾ÐºÐ°
    def take_block(category_filter, needed_toys=0, needed_bowls=0):
        nonlocal used_ids, included_rows

        toys = order_df[(order_df['Category'] == 'Ð˜Ð³Ñ€ÑƒÑˆÐºÐ¸') & (~order_df['Nomenclature_ID'].isin(used_ids))]
        bowls = order_df[(order_df['Category'] == 'ÐœÐ¸ÑÐºÐ¸') & (~order_df['Nomenclature_ID'].isin(used_ids))]

        toys_qty = toys.groupby('Nomenclature_ID')['Quantity'].sum().sum()
        bowls_qty = bowls.groupby('Nomenclature_ID')['Quantity'].sum().sum()

        # ÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð±Ð»Ð¾ÐºÐ¾Ð² Ð¼Ð¾Ð¶Ð½Ð¾ ÑÐ¾Ð±Ñ€Ð°Ñ‚ÑŒ
        if needed_toys > 0 and needed_bowls > 0:
            k = min(toys_qty // needed_toys, bowls_qty // needed_bowls)
        else:
            k = toys_qty // needed_toys if needed_toys > 0 else 0

        if k > 0:
            # ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÐ¼, ÐºÐ°ÐºÐ¸Ðµ SKU Ð¿Ð¾Ð¹Ð´ÑƒÑ‚ Ð² Ð±Ð»Ð¾Ðº
            toys_needed_total = k * needed_toys
            bowls_needed_total = k * needed_bowls

            if needed_toys > 0:
                for idx, row in toys.iterrows():
                    if toys_needed_total <= 0:
                        break
                    take_qty = min(row['Quantity'], toys_needed_total)
                    toys_needed_total -= take_qty
                    included_rows.append(idx)
                    used_ids.add(row['Nomenclature_ID'])

            if needed_bowls > 0:
                for idx, row in bowls.iterrows():
                    if bowls_needed_total <= 0:
                        break
                    take_qty = min(row['Quantity'], bowls_needed_total)
                    bowls_needed_total -= take_qty
                    included_rows.append(idx)
                    used_ids.add(row['Nomenclature_ID'])

        return k

    # 1. Discovery: 25 Ð¸Ð³Ñ€ÑƒÑˆÐµÐº + 15 Ð¼Ð¸ÑÐ¾Ðº
    blocks['Discovery'] = take_block(['Ð˜Ð³Ñ€ÑƒÑˆÐºÐ¸', 'ÐœÐ¸ÑÐºÐ¸'], needed_toys=25, needed_bowls=15)

    # 2. Happy Launch: 40 Ð¸Ð³Ñ€ÑƒÑˆÐµÐº
    blocks['Happy Launch'] = take_block(['Ð˜Ð³Ñ€ÑƒÑˆÐºÐ¸'], needed_toys=40)

    # 3. Play: 20 Ð¸Ð³Ñ€ÑƒÑˆÐµÐº
    blocks['Play'] = take_block(['Ð˜Ð³Ñ€ÑƒÑˆÐºÐ¸'], needed_toys=20)

    return pd.Series({**blocks, 'included_idx': included_rows})
```
2. Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ñ€ÐµÐ¹Ñ‚Ð¸Ð½Ð³Ð¾Ð²Ð¾Ð¹ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹ Ñ Ð±Ñ€ÐµÐ½Ð´-Ð±Ð»Ð¾ÐºÐ°Ð¼Ð¸
```
def make_ranking(summary):
    ranking = summary.copy()

    # Ð”Ð»Ñ ÐºÐ°Ð¶Ð´Ð¾Ð¹ Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ¸ ÑÑ‡Ð¸Ñ‚Ð°ÐµÐ¼ Ð¼ÐµÑÑ‚Ð° (1 = Ð»ÑƒÑ‡ÑˆÐ¸Ð¹ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚)
    ranking["Rank_blocks"] = ranking["Total_blocks"].rank(method="min", ascending=False).astype(int)
    ranking["Rank_contracts"] = ranking["Contracts_with_blocks"].rank(method="min", ascending=False).astype(int)
    ranking["Rank_sales"] = ranking["Sales_sum"].rank(method="min", ascending=False).astype(float)

    # Ð˜Ñ‚Ð¾Ð³Ð¾Ð²Ñ‹Ð¹ Ð±Ð°Ð»Ð» = ÑÑƒÐ¼Ð¼Ð° Ð¼ÐµÑÑ‚
    ranking["Total_score"] = (
        ranking["Rank_blocks"] + ranking["Rank_contracts"] + ranking["Rank_sales"]
    )

    # Ð¡Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²ÐºÐ° Ð¿Ð¾ Ð¸Ñ‚Ð¾Ð³Ð¾Ð²Ð¾Ð¼Ñƒ Ð±Ð°Ð»Ð»Ñƒ
    ranking = ranking.sort_values(by="Total_score")

    return ranking.reset_index(drop=True)
```